{"version":3,"file":"index.js","sources":["../../src/useKeyboardShortcuts.ts","../../src/useDocSearchKeyboardEvents.ts","../../src/useTheme.ts","../../src/DocSearch.tsx"],"sourcesContent":["export interface KeyboardShortcuts {\n  /**\n   * Enable/disable the Ctrl/Cmd+K shortcut to toggle the search modal.\n   *\n   * @default true\n   */\n  'Ctrl/Cmd+K'?: boolean;\n  /**\n   * Enable/disable the / shortcut to open the search modal.\n   *\n   * @default true\n   */\n  '/'?: boolean;\n}\n\n/**\n * Default keyboard shortcuts configuration for DocSearch.\n * These values are used when no keyboardShortcuts prop is provided\n * or when specific shortcuts are not configured.\n */\nexport const DEFAULT_KEYBOARD_SHORTCUTS: Required<KeyboardShortcuts> = {\n  'Ctrl/Cmd+K': true,\n  '/': true,\n} as const;\n\n/**\n * Merges user-provided keyboard shortcuts with defaults.\n *\n * @param userShortcuts - Optional user configuration.\n * @returns Complete keyboard shortcuts configuration with defaults applied.\n */\nexport function useKeyboardShortcuts(userShortcuts?: KeyboardShortcuts): Required<KeyboardShortcuts> {\n  return {\n    ...DEFAULT_KEYBOARD_SHORTCUTS,\n    ...userShortcuts,\n  };\n}\n","import React from 'react';\n\nimport { DEFAULT_KEYBOARD_SHORTCUTS, type KeyboardShortcuts } from './useKeyboardShortcuts';\n\nexport interface UseDocSearchKeyboardEventsProps {\n  isOpen: boolean;\n  onOpen: () => void;\n  onClose: () => void;\n  onInput?: (event: KeyboardEvent) => void;\n  searchButtonRef: React.RefObject<HTMLButtonElement | null>;\n  isAskAiActive: boolean;\n  onAskAiToggle: (toggle: boolean) => void;\n  keyboardShortcuts?: KeyboardShortcuts;\n}\n\nfunction isEditingContent(event: KeyboardEvent): boolean {\n  const element = event.composedPath()[0] as HTMLElement;\n  const tagName = element.tagName;\n\n  return element.isContentEditable || tagName === 'INPUT' || tagName === 'SELECT' || tagName === 'TEXTAREA';\n}\n\nexport function useDocSearchKeyboardEvents({\n  isOpen,\n  isAskAiActive,\n  onAskAiToggle,\n  onClose,\n  onOpen,\n  onInput,\n  searchButtonRef,\n  keyboardShortcuts = DEFAULT_KEYBOARD_SHORTCUTS,\n}: UseDocSearchKeyboardEventsProps): void {\n  React.useEffect(() => {\n    function onKeyDown(event: KeyboardEvent): void {\n      if (isOpen && event.code === 'Escape' && isAskAiActive) {\n        onAskAiToggle(false);\n        return;\n      }\n\n      const isCmdK =\n        keyboardShortcuts['Ctrl/Cmd+K'] && event.key?.toLowerCase() === 'k' && (event.metaKey || event.ctrlKey);\n      const isSlash = keyboardShortcuts['/'] && event.key === '/';\n\n      if ((event.code === 'Escape' && isOpen) || isCmdK || (!isEditingContent(event) && isSlash && !isOpen)) {\n        event.preventDefault();\n\n        if (isOpen) {\n          onClose();\n        } else if (!document.body.classList.contains('DocSearch--active')) {\n          onOpen();\n        }\n\n        return;\n      }\n\n      if (searchButtonRef && searchButtonRef.current === document.activeElement && onInput) {\n        if (/[a-zA-Z0-9]/.test(String.fromCharCode(event.keyCode))) {\n          onInput(event);\n        }\n      }\n    }\n\n    window.addEventListener('keydown', onKeyDown);\n\n    return (): void => {\n      window.removeEventListener('keydown', onKeyDown);\n    };\n  }, [isOpen, isAskAiActive, searchButtonRef, keyboardShortcuts, onOpen, onClose, onInput, onAskAiToggle]);\n}\n","import { useEffect } from 'react';\n\nexport type DocSearchTheme = 'dark' | 'light';\n\nexport interface UseThemeProps {\n  theme?: DocSearchTheme;\n}\n\nexport const useTheme = ({ theme }: UseThemeProps): void => {\n  useEffect(() => {\n    if (!theme) {\n      return undefined;\n    }\n\n    const previousTheme = document.documentElement.dataset.theme;\n\n    if (theme === previousTheme) {\n      return undefined;\n    }\n\n    document.documentElement.dataset.theme = theme;\n\n    return (): void => {\n      if (previousTheme === undefined) {\n        delete document.documentElement.dataset.theme;\n      } else {\n        document.documentElement.dataset.theme = previousTheme;\n      }\n    };\n  }, [theme]);\n};\n","import type { JSX } from 'react';\nimport React from 'react';\n\nimport { useDocSearchKeyboardEvents } from './useDocSearchKeyboardEvents';\nimport { useKeyboardShortcuts } from './useKeyboardShortcuts';\nimport type { KeyboardShortcuts } from './useKeyboardShortcuts.ts';\nimport type { DocSearchTheme } from './useTheme';\nimport { useTheme } from './useTheme';\n\nexport type DocSearchState = 'modal-askai' | 'modal-search' | 'ready';\n\nexport interface DocSearchContext {\n  docsearchState: DocSearchState;\n  setDocsearchState: (newState: DocSearchState) => void;\n  searchButtonRef: React.RefObject<HTMLButtonElement | null>;\n  initialQuery: string;\n  keyboardShortcuts: Required<KeyboardShortcuts>;\n  openModal: () => void;\n  closeModal: () => void;\n  isAskAiActive: boolean;\n  isModalActive: boolean;\n  onAskAiToggle: (active: boolean) => void;\n}\n\nexport interface DocSearchProps {\n  children: Array<JSX.Element | null> | JSX.Element | React.ReactNode | null;\n  theme?: DocSearchTheme;\n  initialQuery?: string;\n  keyboardShortcuts?: KeyboardShortcuts;\n}\n\nconst Context = React.createContext<DocSearchContext | undefined>(undefined);\nContext.displayName = 'DocSearchContext';\n\nexport function DocSearch({ children, theme, ...props }: DocSearchProps): JSX.Element {\n  const [docsearchState, setDocsearchState] = React.useState<DocSearchState>('ready');\n  const [initialQuery, setInitialQuery] = React.useState<string>(props.initialQuery || '');\n  const searchButtonRef = React.useRef<HTMLButtonElement>(null);\n  const keyboardShortcuts = useKeyboardShortcuts(props.keyboardShortcuts);\n\n  const isModalActive = ['modal-search', 'modal-askai'].includes(docsearchState);\n  const isAskAiActive = docsearchState === 'modal-askai';\n\n  const openModal = React.useCallback((): void => {\n    setDocsearchState('modal-search');\n  }, []);\n\n  const closeModal = React.useCallback((): void => {\n    setDocsearchState('ready');\n    searchButtonRef.current?.focus();\n    setInitialQuery(props.initialQuery ?? '');\n  }, [setDocsearchState, props.initialQuery]);\n\n  const onAskAiToggle = React.useCallback(\n    (active: boolean): void => {\n      setDocsearchState(active ? 'modal-askai' : 'modal-search');\n    },\n    [setDocsearchState],\n  );\n\n  const onInput = React.useCallback(\n    (event: KeyboardEvent): void => {\n      setDocsearchState('modal-search');\n      setInitialQuery(event.key);\n    },\n    [setDocsearchState, setInitialQuery],\n  );\n\n  useTheme({ theme });\n\n  useDocSearchKeyboardEvents({\n    isOpen: isModalActive,\n    onOpen: openModal,\n    onClose: closeModal,\n    onAskAiToggle,\n    onInput,\n    isAskAiActive,\n    searchButtonRef,\n    keyboardShortcuts,\n  });\n\n  const value: DocSearchContext = React.useMemo(\n    () => ({\n      docsearchState,\n      setDocsearchState,\n      searchButtonRef,\n      initialQuery,\n      keyboardShortcuts,\n      openModal,\n      closeModal,\n      isAskAiActive,\n      isModalActive,\n      onAskAiToggle,\n    }),\n    [\n      docsearchState,\n      searchButtonRef,\n      initialQuery,\n      keyboardShortcuts,\n      openModal,\n      closeModal,\n      isAskAiActive,\n      isModalActive,\n      onAskAiToggle,\n    ],\n  );\n\n  return <Context.Provider value={value}>{children}</Context.Provider>;\n}\nDocSearch.displayName = 'DocSearch';\n\nexport function useDocSearch(): DocSearchContext {\n  const ctx = React.useContext(Context);\n\n  if (ctx === undefined) {\n    throw new Error('`useDocSearch` must be used within the `DocSearch` provider');\n  }\n\n  return ctx;\n}\n"],"names":["DEFAULT_KEYBOARD_SHORTCUTS","useKeyboardShortcuts","userShortcuts","_objectSpread","useDocSearchKeyboardEvents","_ref","isOpen","isAskAiActive","onAskAiToggle","onClose","onOpen","onInput","searchButtonRef","_ref$keyboardShortcut","keyboardShortcuts","React","useEffect","onKeyDown","event","_event$key","code","isCmdK","key","toLowerCase","metaKey","ctrlKey","isSlash","element","composedPath","tagName","isContentEditable","isEditingContent","preventDefault","document","body","classList","contains","current","activeElement","test","String","fromCharCode","keyCode","window","addEventListener","removeEventListener","useTheme","theme","previousTheme","documentElement","dataset","undefined","Context","createContext","DocSearch","children","props","_objectWithoutProperties","_excluded","_React$useState2","_slicedToArray","useState","docsearchState","setDocsearchState","_React$useState4","initialQuery","setInitialQuery","useRef","isModalActive","includes","openModal","useCallback","closeModal","_searchButtonRef$curr","_props$initialQuery","focus","active","value","useMemo","createElement","Provider","displayName","ctx","useContext","Error"],"mappings":"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"}