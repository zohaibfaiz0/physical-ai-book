"use strict";(globalThis.webpackChunkphysical_ai_humanoid_robotics_book=globalThis.webpackChunkphysical_ai_humanoid_robotics_book||[]).push([[8401],{8541:(t,o,e)=>{e.d(o,{A:()=>c});var n=e(6540),a=e(5309),r=e(7420),s=e(4848);const i=({chapterId:t})=>{const[o,e]=(0,n.useState)(!1),[a,i]=(0,n.useState)(!0),[c,l]=(0,n.useState)(null);(0,n.useEffect)(()=>{(async()=>{try{const t=await(0,r.jp)();l(t),t&&await d(t.id)}catch(t){console.error("Error fetching user or completion status:",t)}finally{i(!1)}})()},[t]);const d=async o=>{try{const o=(0,r.gf)();if(!o)return;const n=await fetch(`${r.H$}/progress`,{headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});if(n.ok){const o=(await n.json()).progress.map(t=>t.chapter_id);e(o.includes(t))}}catch(n){console.error("Error checking completion status:",n)}};return a?(0,s.jsx)("button",{className:"completion-btn loading",disabled:!0,children:(0,s.jsx)("span",{children:"Loading..."})}):c?(0,s.jsx)("button",{className:"completion-btn "+(o?"completed":"incomplete"),onClick:async()=>{if(c){i(!0);try{const o=(0,r.gf)();if(!o)throw new Error("No authentication token found");const n=await fetch(`${r.H$}/progress/toggle`,{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify({chapter_id:t})});if(!n.ok){const t=await n.json();throw new Error(t.detail||"Failed to update progress")}{const t=await n.json();e(t.completed)}}catch(o){console.error("Error toggling completion:",o),alert(`Error updating progress: ${o.message}`)}finally{i(!1)}}else alert("Please sign in to track your progress")},disabled:a,title:o?"Click to mark as incomplete":"Click to mark as complete",children:(0,s.jsx)("span",{children:o?"\u2713 Completed":"Mark Complete"})}):(0,s.jsx)("button",{className:"completion-btn disabled",disabled:!0,title:"Sign in to track your progress",children:(0,s.jsx)("span",{children:"\ud83d\udd12 Sign in to track"})})};function c(t){let o="";try{const{useDoc:t}=e(4721),{metadata:n}=t();o=n.id||n.slug||""}catch(r){o="undefined"!=typeof window?window.location.pathname:""}return(0,s.jsxs)(n.Fragment,{children:[(0,s.jsx)("div",{style:{marginBottom:"1rem",marginTop:"1rem"},children:(0,s.jsx)(i,{chapterId:o})}),(0,s.jsx)(a.A,{...t})]})}}}]);