"use strict";(globalThis.webpackChunkphysical_ai_humanoid_robotics_book=globalThis.webpackChunkphysical_ai_humanoid_robotics_book||[]).push([[9004],{4106:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"chapters/weeks-6-7-simulation/index","title":"index","description":"---","source":"@site/docs/chapters/03-weeks-6-7-simulation/index.mdx","sourceDirName":"chapters/03-weeks-6-7-simulation","slug":"/chapters/weeks-6-7-simulation/","permalink":"/physical-ai-book/docs/chapters/weeks-6-7-simulation/","draft":false,"unlisted":false,"editUrl":"https://github.com/zohaibfaiz0/physical-ai-book/docs/chapters/03-weeks-6-7-simulation/index.mdx","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"ROS 2 Project Walkthrough: Building a Complete Humanoid Robot System","permalink":"/physical-ai-book/docs/chapters/weeks-3-5-ros2/ros2-project-walkthrough"},"next":{"title":"Gazebo Mastery 2025: Advanced Simulation Techniques and Best Practices","permalink":"/physical-ai-book/docs/chapters/weeks-6-7-simulation/gazebo-mastery-2025"}}');var s=n(4848),r=n(8453),a=n(9342);const o={},l=void 0,d={},c=[{value:"title: &quot;Weeks 6\u20137 \u2013 Digital Twins: Gazebo &amp; Unity Simulation&quot;\ndescription: &quot;Creating virtual environments for robot development and testing with physics-accurate simulation&quot;\nweek: &quot;Weeks 6\u20137&quot;",id:"title-weeks-67--digital-twins-gazebo--unity-simulationdescription-creating-virtual-environments-for-robot-development-and-testing-with-physics-accurate-simulationweek-weeks-67",level:2},{value:"The Virtual Laboratory: Where Robots Learn Before They Live",id:"the-virtual-laboratory-where-robots-learn-before-they-live",level:2},{value:"Core Learning Outcomes",id:"core-learning-outcomes",level:2},{value:"Key Technologies and Simulation Platforms",id:"key-technologies-and-simulation-platforms",level:2},{value:"Sensor Simulation Matrix",id:"sensor-simulation-matrix",level:2},{value:"The Sim-to-Real Pipeline",id:"the-sim-to-real-pipeline",level:2},{value:"Cornerstone Citations",id:"cornerstone-citations",level:2},{value:"Bridging the Reality Gap",id:"bridging-the-reality-gap",level:2}];function h(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h2,{id:"title-weeks-67--digital-twins-gazebo--unity-simulationdescription-creating-virtual-environments-for-robot-development-and-testing-with-physics-accurate-simulationweek-weeks-67",children:'title: "Weeks 6\u20137 \u2013 Digital Twins: Gazebo & Unity Simulation"\ndescription: "Creating virtual environments for robot development and testing with physics-accurate simulation"\nweek: "Weeks 6\u20137"'}),"\n",(0,s.jsx)(t.h1,{id:"weeks-67--digital-twins-gazebo--unity-simulation",children:"Weeks 6\u20137 \u2013 Digital Twins: Gazebo & Unity Simulation"}),"\n",(0,s.jsx)(a.A,{}),"\n",(0,s.jsx)(t.h2,{id:"the-virtual-laboratory-where-robots-learn-before-they-live",children:"The Virtual Laboratory: Where Robots Learn Before They Live"}),"\n",(0,s.jsx)(t.p,{children:"In the physical world, failure is expensive, time-consuming, and sometimes dangerous. A robot that falls down a flight of stairs in reality might be damaged beyond repair, requiring weeks of repairs and thousands of dollars in replacement parts. But in the digital realm of simulation, failure becomes a learning opportunity rather than a catastrophe. Here, in the virtual laboratory of digital twins, robots can stumble, crash, and experiment millions of times without consequence, learning from each virtual experience to perform better in the real world."}),"\n",(0,s.jsx)(t.p,{children:"Digital twins\u2014virtual replicas of physical systems\u2014have revolutionized how we develop and test robotic systems. By creating physics-accurate simulations of both the robot and its environment, we can accelerate the learning process exponentially, testing complex behaviors and algorithms in a safe, controlled, and repeatable environment before deploying them in the physical world."}),"\n",(0,s.jsx)(t.h2,{id:"core-learning-outcomes",children:"Core Learning Outcomes"}),"\n",(0,s.jsx)(t.p,{children:"By the end of this module, you will be able to:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Design and configure simulation environments that accurately model real-world physics"}),"\n",(0,s.jsx)(t.li,{children:"Integrate sensor models that faithfully replicate real sensor behavior in simulation"}),"\n",(0,s.jsx)(t.li,{children:"Implement robot models with realistic dynamics and kinematics"}),"\n",(0,s.jsx)(t.li,{children:"Execute transfer learning strategies from simulation to real-world deployment"}),"\n",(0,s.jsx)(t.li,{children:'Evaluate the "reality gap" between simulated and real environments'}),"\n",(0,s.jsx)(t.li,{children:"Configure physics parameters to match real-world conditions"}),"\n",(0,s.jsx)(t.li,{children:"Validate robot behaviors in simulation before physical testing"}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"key-technologies-and-simulation-platforms",children:"Key Technologies and Simulation Platforms"}),"\n",(0,s.jsx)(t.p,{children:"This module introduces you to the foundational simulation technologies that enable digital twin development:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Gazebo"}),": The physics-based simulation environment that provides realistic physics, sensor simulation, and rendering capabilities"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Unity Simulation"}),": The game-engine-based platform that offers high-fidelity graphics and complex environment modeling"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Digital Twin Architecture"}),": The framework connecting virtual models to real-world systems for bidirectional learning"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Physics Engines"}),": The computational systems that simulate real-world forces, collisions, and dynamics"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Sensor Simulation"}),": The virtual sensors that replicate real-world sensing capabilities with realistic noise and limitations"]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"sensor-simulation-matrix",children:"Sensor Simulation Matrix"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Sensor Type"}),(0,s.jsx)(t.th,{children:"Gazebo Support"}),(0,s.jsx)(t.th,{children:"Unity Support"}),(0,s.jsx)(t.th,{children:"Accuracy Level"}),(0,s.jsx)(t.th,{children:"Use Cases"}),(0,s.jsx)(t.th,{children:"Reality Gap Risk"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"RGB Camera"}),(0,s.jsx)(t.td,{children:"\u2705 Native"}),(0,s.jsx)(t.td,{children:"\u2705 Native"}),(0,s.jsx)(t.td,{children:"High"}),(0,s.jsx)(t.td,{children:"Vision, Navigation"}),(0,s.jsx)(t.td,{children:"Low"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Depth Camera"}),(0,s.jsx)(t.td,{children:"\u2705 Native"}),(0,s.jsx)(t.td,{children:"\u2705 Native"}),(0,s.jsx)(t.td,{children:"High"}),(0,s.jsx)(t.td,{children:"3D Mapping, Obstacle Detection"}),(0,s.jsx)(t.td,{children:"Medium"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"LIDAR"}),(0,s.jsx)(t.td,{children:"\u2705 Native"}),(0,s.jsx)(t.td,{children:"Plugin"}),(0,s.jsx)(t.td,{children:"High"}),(0,s.jsx)(t.td,{children:"Mapping, Localization"}),(0,s.jsx)(t.td,{children:"Low"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"IMU"}),(0,s.jsx)(t.td,{children:"\u2705 Native"}),(0,s.jsx)(t.td,{children:"\u2705 Native"}),(0,s.jsx)(t.td,{children:"High"}),(0,s.jsx)(t.td,{children:"Orientation, Acceleration"}),(0,s.jsx)(t.td,{children:"Low"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Force/Torque"}),(0,s.jsx)(t.td,{children:"\u2705 Native"}),(0,s.jsx)(t.td,{children:"Limited"}),(0,s.jsx)(t.td,{children:"Medium"}),(0,s.jsx)(t.td,{children:"Manipulation, Grasping"}),(0,s.jsx)(t.td,{children:"High"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"GPS"}),(0,s.jsx)(t.td,{children:"\u2705 Native"}),(0,s.jsx)(t.td,{children:"Limited"}),(0,s.jsx)(t.td,{children:"Medium"}),(0,s.jsx)(t.td,{children:"Outdoor Navigation"}),(0,s.jsx)(t.td,{children:"High"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Joint Encoders"}),(0,s.jsx)(t.td,{children:"\u2705 Native"}),(0,s.jsx)(t.td,{children:"\u2705 Native"}),(0,s.jsx)(t.td,{children:"Very High"}),(0,s.jsx)(t.td,{children:"Kinematics, Control"}),(0,s.jsx)(t.td,{children:"Very Low"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Accelerometer"}),(0,s.jsx)(t.td,{children:"\u2705 Native"}),(0,s.jsx)(t.td,{children:"\u2705 Native"}),(0,s.jsx)(t.td,{children:"High"}),(0,s.jsx)(t.td,{children:"Motion Detection"}),(0,s.jsx)(t.td,{children:"Low"})]})]})]}),"\n",(0,s.jsx)(t.h2,{id:"the-sim-to-real-pipeline",children:"The Sim-to-Real Pipeline"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-mermaid",children:"graph TD\n    A[Physical Robot] --\x3e B[Real World Data]\n    B --\x3e C[Reality Gap Analysis]\n    C --\x3e D[Simulation Model Refinement]\n    D --\x3e E[Gazebo/Unity Simulation]\n    E --\x3e F[Virtual Robot Training]\n    F --\x3e G[Policy Learning]\n    G --\x3e H[Transfer to Physical Robot]\n    H --\x3e A\n    I[Unity Asset Library] --\x3e E\n    J[Gazebo Models] --\x3e E\n    K[Physics Parameters] --\x3e E\n    L[Sensor Models] --\x3e E\n    E --\x3e M[Performance Validation]\n    M --\x3e G\n"})}),"\n",(0,s.jsx)(t.h2,{id:"cornerstone-citations",children:"Cornerstone Citations"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Coltin, B., et al. (2014). Design and use paradigms for Gazebo, an open-source multi-robot simulator. ",(0,s.jsx)(t.em,{children:"IEEE/RSJ International Conference on Intelligent Robots and Systems"}),", 1453-1458. ",(0,s.jsx)(t.a,{href:"https://doi.org/10.1109/IROS.2014.6942710",children:"DOI:10.1109/IROS.2014.6942710"})]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["James, S., et al. (2020). PyBullet: A Python module for physics simulation for games, robotics and machine learning. ",(0,s.jsx)(t.em,{children:"arXiv preprint arXiv:1906.06249"}),". ",(0,s.jsx)(t.a,{href:"https://arxiv.org/abs/1906.06249",children:"arXiv:1906.06249"})]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Sadeghi, F., & Levine, S. (2017). CAD2RL: Real single-image flight without a single real image. ",(0,s.jsx)(t.em,{children:"Proceedings of Robotics: Science and Systems"}),". ",(0,s.jsx)(t.a,{href:"https://doi.org/10.15607/RSS.2017.XIII.016",children:"DOI:10.15607/RSS.2017.XIII.016"})]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["OpenAI, et al. (2019). Learning dexterous in-hand manipulation. ",(0,s.jsx)(t.em,{children:"The International Journal of Robotics Research"}),", 39(7), 761-784. ",(0,s.jsx)(t.a,{href:"https://doi.org/10.1177/0278364919887320",children:"DOI:10.1177/0278364919887320"})]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Tobin, J., et al. (2017). Domain randomization for transferring deep neural networks from simulation to the real world. ",(0,s.jsx)(t.em,{children:"IEEE/RSJ International Conference on Intelligent Robots and Systems"}),", 23-30. ",(0,s.jsx)(t.a,{href:"https://doi.org/10.1109/IROS.2017.8202133",children:"DOI:10.1109/IROS.2017.8202133"})]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Chebotar, Y., et al. (2019). Closing the sim-to-real loop: Adapting simulation randomizations with real world experience. ",(0,s.jsx)(t.em,{children:"IEEE International Conference on Robotics and Automation"}),", 8973-8979. ",(0,s.jsx)(t.a,{href:"https://doi.org/10.1109/ICRA.2019.8793745",children:"DOI:10.1109/ICRA.2019.8793745"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"bridging-the-reality-gap",children:"Bridging the Reality Gap"}),"\n",(0,s.jsx)(t.p,{children:"The journey from simulation to reality is not a simple translation but a complex process of validation, refinement, and adaptation. The digital twin approach allows us to test millions of scenarios in virtual environments, but the ultimate test remains in the unpredictable complexity of the real world. As we advance through this module, you'll learn to design simulation environments that minimize the reality gap while maximizing the learning potential of your virtual experiments."}),"\n",(0,s.jsx)(t.p,{children:"The digital laboratory awaits your exploration\u2014where virtual robots learn the skills they'll need to navigate the physical world."})]})}function u(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>o});var i=n(6540);const s={},r=i.createContext(s);function a(e){const t=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(r.Provider,{value:t},e.children)}},9342:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(6540),s=n(7710),r=n(4848);const a=()=>{const[e,t]=(0,i.useState)(!1),[n,a]=(0,i.useState)([]),[o,l]=(0,i.useState)(""),[d,c]=(0,i.useState)(!1),[h,u]=(0,i.useState)(""),[m,x]=(0,i.useState)(null),{colorMode:g}=(0,s.G)(),p=(0,i.useRef)(null);(0,i.useEffect)(()=>{(async()=>{try{const e="http://localhost:8000";(await fetch(`${e}/health`)).ok||x("Backend server is not running. Please start the backend server to use the chatbot.")}catch(m){x("Backend server is not running. Please start the backend server to use the chatbot.")}})()},[]),(0,i.useEffect)(()=>{const e=()=>{const e=window.getSelection()?.toString().trim();e&&e.length>10&&u(e)};return document.addEventListener("mouseup",e),document.addEventListener("keyup",e),()=>{document.removeEventListener("mouseup",e),document.removeEventListener("keyup",e)}},[]),(0,i.useEffect)(()=>{p.current?.scrollIntoView({behavior:"smooth"})},[n]);const b=async()=>{if(!o.trim()||d)return;const e={id:Date.now().toString(),role:"user",content:o,timestamp:new Date};a(t=>[...t,e]),l(""),c(!0),x(null);try{const e="http://localhost:8000",t=await fetch(`${e}/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:o,selected_text:h||null,conversation_id:j()})});if(!t.ok)throw new Error(`Chat API error: ${t.status} ${t.statusText}`);const n=Date.now().toString(),i={id:n,role:"assistant",content:"",timestamp:new Date};a(e=>[...e,i]);const s=t.body?.getReader();if(s){let e="";for(;;){const{done:t,value:i}=await s.read();if(t)break;const r=(new TextDecoder).decode(i);e+=r,a(t=>t.map(t=>t.id===n?{...t,content:e}:t))}s.releaseLock()}else{const e=await t.json();a(t=>t.map(t=>t.id===n?{...t,content:e.answer||e.response||"I processed your request successfully."}:t))}}catch(m){console.error("Error sending message:",m);const t=m.message||"Failed to connect to the chat service";x(`Failed to connect to the chat service: ${t}`),a(e=>{const n=e[e.length-1];return n&&"assistant"===n.role?[...e.slice(0,-1),{...n,content:`I'm having trouble connecting to the knowledge base. Error: ${t}\n\nTo use the chatbot, please:\n\n1. Make sure you have Python installed\n2. Navigate to the backend directory: \`cd backend\`\n3. Install dependencies: \`pip install -r requirements.txt\`\n4. Start the backend: \`python -m uvicorn app.main:app --host 0.0.0.0 --port 8000\`\n\nThe chatbot will connect to \`http://localhost:8000\` by default.`}]:[...e,{id:Date.now().toString(),role:"assistant",content:`I'm having trouble connecting to the knowledge base. Error: ${t}\n\nTo use the chatbot, please:\n\n1. Make sure you have Python installed\n2. Navigate to the backend directory: \`cd backend\`\n3. Install dependencies: \`pip install -r requirements.txt\`\n4. Start the backend: \`python -m uvicorn app.main:app --host 0.0.0.0 --port 8000\`\n\nThe chatbot will connect to \`http://localhost:8000\` by default.`,timestamp:new Date}]})}finally{c(!1),u("")}},j=()=>{let e=localStorage.getItem("bookChatConversationId");return e||(e=`conv_${Date.now()}`,localStorage.setItem("bookChatConversationId",e)),e};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>{t(!e)},className:"fixed bottom-6 right-6 z-50 w-14 h-14 rounded-full flex items-center justify-center shadow-lg transition-all duration-300 "+("dark"===g?"bg-blue-600 hover:bg-blue-700 text-white":"bg-blue-500 hover:bg-blue-600 text-white"),"aria-label":"Open chat",title:"Book Assistant",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),e&&(0,r.jsxs)("div",{className:"fixed bottom-20 right-4 z-50 w-full max-w-[90%] sm:max-w-md h-[60vh] sm:h-[70vh] max-h-[600px] flex flex-col rounded-lg shadow-xl overflow-hidden border border-gray-300 dark:border-gray-600",children:[(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 "+("dark"===g?"bg-gray-800 text-white":"bg-white text-gray-900"),children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4 p-2 rounded-t-lg "+("dark"===g?"bg-gradient-to-r from-blue-700 to-blue-800":"bg-gradient-to-r from-blue-500 to-blue-600 text-white"),children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),(0,r.jsx)("h3",{className:"font-semibold",children:"Book Assistant"})]}),(0,r.jsx)("button",{onClick:()=>{a([]),x(null)},className:"text-sm px-2 py-1 rounded text-xs "+("dark"===g?"bg-blue-800 hover:bg-blue-700":"bg-blue-600 hover:bg-blue-700 text-white"),children:"New Chat"})]}),(0,r.jsxs)("div",{className:"space-y-4 mb-4",children:[m&&(0,r.jsx)("div",{className:"p-3 rounded-lg mb-4 "+("dark"===g?"bg-red-900/30 border border-red-700 text-red-200":"bg-red-100 border border-red-200 text-red-800"),children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,r.jsx)("div",{className:"text-sm",children:m})]})}),0===n.length?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,r.jsx)("div",{className:"flex justify-center mb-4",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 mx-auto text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),(0,r.jsx)("p",{className:"font-medium",children:"Ask me anything about the book!"}),h&&(0,r.jsxs)("div",{className:"text-xs mt-3 p-3 rounded-lg "+("dark"===g?"bg-blue-900/30 border border-blue-700":"bg-blue-100 border border-blue-200"),children:[(0,r.jsx)("p",{className:"font-medium mb-1 "+("dark"===g?"text-blue-300":"text-blue-800"),children:"Selected text:"}),(0,r.jsxs)("p",{className:"italic",children:[h.substring(0,150),h.length>150?"...":""]})]}),(0,r.jsx)("p",{className:"text-xs mt-4 max-w-xs mx-auto",children:"I can help explain concepts, provide examples, and answer questions from the Physical AI and Humanoid Robotics book."})]}):(0,r.jsxs)(r.Fragment,{children:[n.map(e=>(0,r.jsxs)("div",{className:"p-3 rounded-lg max-w-[85%] "+("user"===e.role?"dark"===g?"bg-blue-700 text-white ml-auto rounded-br-none":"bg-blue-500 text-white ml-auto rounded-br-none":"dark"===g?"bg-gray-700 text-white rounded-bl-none":"bg-gray-100 text-gray-800 rounded-bl-none"),children:[(0,r.jsx)("div",{className:"whitespace-pre-wrap break-words",children:e.content}),(0,r.jsx)("div",{className:"text-xs mt-1 "+("user"===e.role?"dark"===g?"text-blue-200":"text-blue-100":"dark"===g?"text-gray-400":"text-gray-600"),children:e.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},e.id)),d&&(0,r.jsx)("div",{className:"p-3 rounded-lg max-w-[85%] "+("dark"===g?"bg-gray-700 text-white":"bg-gray-100 text-gray-800"),children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"mr-2",children:"Thinking..."}),(0,r.jsxs)("div",{className:"flex space-x-1",children:[(0,r.jsx)("div",{className:"w-2 h-2 rounded-full animate-bounce "+("dark"===g?"bg-gray-300":"bg-gray-600")}),(0,r.jsx)("div",{className:"w-2 h-2 rounded-full animate-bounce delay-75 "+("dark"===g?"bg-gray-300":"bg-gray-600")}),(0,r.jsx)("div",{className:"w-2 h-2 rounded-full animate-bounce delay-150 "+("dark"===g?"bg-gray-300":"bg-gray-600")})]})]})}),(0,r.jsx)("div",{ref:p})]})]})]}),(0,r.jsxs)("div",{className:"p-3 border-t "+("dark"===g?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[h&&(0,r.jsxs)("div",{className:"text-xs mb-2 p-2 rounded "+("dark"===g?"bg-gray-700":"bg-gray-100"),children:['Using selected text: "',h.substring(0,50),h.length>50?"...":"",'"']}),(0,r.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("input",{type:"text",value:o,onChange:e=>l(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),b())},placeholder:h?"Ask about selected text...":"Message the book assistant...",className:"flex-1 p-2 rounded-l-lg border "+("dark"===g?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"),disabled:d,autoFocus:!0}),(0,r.jsx)("button",{onClick:b,disabled:d||!o.trim(),className:"px-4 rounded-r-lg flex items-center "+(d||!o.trim()?"dark"===g?"bg-gray-600 text-gray-400":"bg-gray-300 text-gray-500":"dark"===g?"bg-blue-600 hover:bg-blue-700 text-white":"bg-blue-500 hover:bg-blue-600 text-white"),children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M5 5l7 7-7 7"})})})]}),(0,r.jsx)("button",{onClick:async()=>{try{const e="http://localhost:8000",t=await fetch(`${e}/health`),n=await t.json();t.ok?alert(`Connection successful! Status: ${n.status}`):alert(`Connection failed! Status: ${n.status}`)}catch(m){alert(`Connection test failed: ${m}`)}},className:"px-4 py-2 rounded-lg flex items-center justify-center "+("dark"===g?"bg-green-700 hover:bg-green-600 text-white":"bg-green-500 hover:bg-green-600 text-white"),children:"Test Connection"})]})]})]})]})}}}]);